
'use strict';var restaurants=void 0,neighborhoods=void 0,cuisines=void 0;var map;var markers=[];var io=new IntersectionObserver(function(entries){entries.forEach(function(entry){if(entry.intersectionRatio>0.3){var image=entry.target.firstChild;image.src=image.dataset.src;}});},{root:document.querySelector('#scrollArea'),rootMargin:'0px',threshold:0.5});document.addEventListener('DOMContentLoaded',function(event){DBHelper.fetchRestaurants().then(function(){return DBHelper.fetchReviews();}).then(function(){fetchNeighborhoods();fetchCuisines();});});fetchNeighborhoods=function fetchNeighborhoods(){DBHelper.fetchNeighborhoods(function(error,neighborhoods){if(error){console.error(error);}else{self.neighborhoods=neighborhoods;fillNeighborhoodsHTML();}});};fillNeighborhoodsHTML=function fillNeighborhoodsHTML(){var neighborhoods=arguments.length>0&&arguments[0]!==undefined?arguments[0]:self.neighborhoods;var select=document.getElementById('neighborhoods-select');neighborhoods.forEach(function(neighborhood){var option=document.createElement('option');option.innerHTML=neighborhood;option.value=neighborhood;select.append(option);});};fetchCuisines=function fetchCuisines(){DBHelper.fetchCuisines(function(error,cuisines){if(error){console.error(error);}else{self.cuisines=cuisines;fillCuisinesHTML();}});};fillCuisinesHTML=function fillCuisinesHTML(){var cuisines=arguments.length>0&&arguments[0]!==undefined?arguments[0]:self.cuisines;var select=document.getElementById('cuisines-select');cuisines.forEach(function(cuisine){var option=document.createElement('option');option.innerHTML=cuisine;option.value=cuisine;select.append(option);});};window.initMap=function(){var loc={lat:40.722216,lng:-73.987501};map=new google.maps.Map(document.getElementById('map'),{zoom:12,center:loc,scrollwheel:false});map.addListener('tilesloaded',function(){document.getElementById('map-container').style.height='400px';});updateRestaurants();};toggleMap=function toggleMap(e){console.log(e);if(e.textContent==='Show map'){document.getElementById('map-container').style.height='400px';e.innerHTML='Hide map';}else{document.getElementById('map-container').style.height='0px';e.innerHTML='Show map';}};updateRestaurants=function updateRestaurants(){var cSelect=document.getElementById('cuisines-select');var nSelect=document.getElementById('neighborhoods-select');var cIndex=cSelect.selectedIndex;var nIndex=nSelect.selectedIndex;var cuisine=cSelect[cIndex].value;var neighborhood=nSelect[nIndex].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(cuisine,neighborhood,function(error,restaurants){if(error){console.error(error);}else{resetRestaurants(restaurants);fillRestaurantsHTML();}});};resetRestaurants=function resetRestaurants(restaurants){self.restaurants=[];var ul=document.getElementById('restaurants-list');ul.innerHTML='';self.markers.forEach(function(m){return m.setMap(null);});self.markers=[];self.restaurants=restaurants;};fillRestaurantsHTML=function fillRestaurantsHTML(){var restaurants=arguments.length>0&&arguments[0]!==undefined?arguments[0]:self.restaurants;var ul=document.getElementById('restaurants-list');restaurants.forEach(function(restaurant){var li=createRestaurantHTML(restaurant);ul.append(li);io.observe(li);});addMarkersToMap();};createRestaurantHTML=function createRestaurantHTML(restaurant){var li=document.createElement('li');var image=document.createElement('img');image.className='restaurant-img';image.alt='Restaurant '+restaurant.name+' (thumbnail)';image.dataset.src=DBHelper.imageUrlForRestaurant(restaurant,'-small');li.append(image);var name=document.createElement('h2');name.innerHTML=restaurant.name;li.append(name);var neighborhood=document.createElement('p');neighborhood.innerHTML=restaurant.neighborhood;li.append(neighborhood);var address=document.createElement('p');address.innerHTML=restaurant.address;li.append(address);var more=document.createElement('a');more.innerHTML='View Details';more.href=DBHelper.urlForRestaurant(restaurant);li.append(more);return li;};addMarkersToMap=function addMarkersToMap(){var restaurants=arguments.length>0&&arguments[0]!==undefined?arguments[0]:self.restaurants;restaurants.forEach(function(restaurant){var marker=DBHelper.mapMarkerForRestaurant(restaurant,self.map);google.maps.event.addListener(marker,'click',function(){window.location.href=marker.url;});self.markers.push(marker);});};